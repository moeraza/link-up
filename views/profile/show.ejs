<% include ../partials/header %>

<div class="container">
  <div class="row justify-content-center align-items-center">
    <div class="col-12 col-md-4">
      <h1 class="text-center">
        <%= username %>'s Links
      </h1>
      <img src="<%= thisUser.avatar%>">
    </div>
  </div>
  <div class="row justify-content-center align-items-center">
    <div class="col-12 col-md-4">
      <% links.forEach(function(link){ %>
      
      <form id="links-form" action="/<%= username %>/<%= link._id %>" method="POST">
        <button type="submit" class="btn btn-primary"><%= link.name %></button>
      </form>
      
          <% if (currentUser && currentUser._id.equals(link.author.id)){ %>
          <a class="btn btn-sm btn-warning" id="edit-button" href="/<%= currentUser.username %>/<%= link._id %>/edit">Edit</a>
          <form id="delete-form" action="/<%= currentUser.username%>/<%= link._id %>?_method=DELETE" method="POST">
            <button class="btn btn-sm btn-danger"><i class="far fa-trash-alt"></i>Delete</button>
          </form>
            
        <% } %>

      <% }); %>
      
      <% if (currentUser && currentUser._id.equals(currentUser._id)){ %>
      <a class="btn btn-success" id="addlinkbutton" href="/<%= currentUser.username %>/new">Add New Link</a>
       <% } %>

    </div>
  </div>

</div>

  
<script>
  var defaultBackground = "background: #6190E8;  /* fallback for old browsers */ background: -webkit-linear-gradient(to right, #A7BFE8, #6190E8);  /* Chrome 10-25, Safari 5.1-6 */  background: linear-gradient(to right, #A7BFE8, #6190E8); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */ "
  
  function myFunction() {
  // document.body.style.background = "#a8ff78";
  try {
    document.body.style = "<%=  thisUser.themeColor %>";
  } catch(err) {
    console.log("There is no color assigned to user will assign default color", err);
    document.body.style = defaultBackground;
  }
  
}

myFunction();
</script>

<% include ../partials/footer %>